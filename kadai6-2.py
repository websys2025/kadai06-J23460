import requests
import json

# ------------------------------------------------------------
# 【使用するオープンデータ】
# 気象庁 天気予報（無料・APIキー不要）
# https://www.jma.go.jp/bosai/forecast/
# ------------------------------------------------------------
# データ概要：
# - 各都道府県ごとの天気予報（今日・明日・明後日など）
# - JSON形式で提供されている
# - API形式ではないが、URLアクセスで取得可能
# ------------------------------------------------------------

# 地域コードの設定（東京地方：130000）
area_code = "130000"

# 気象庁の天気予報データURL
url = f"https://www.jma.go.jp/bosai/forecast/data/forecast/{area_code}.json"

# ------------------------------------------------------------
# 【データ取得処理】
# ------------------------------------------------------------
response = requests.get(url)

# 応答チェック
if response.status_code != 200:
    print("データの取得に失敗しました。")
    exit()

# JSONデータをパース
data = response.json()

# ------------------------------------------------------------
# 【データの表示】
# - 地方名、発表日時、天気、気温、風などを表示
# ------------------------------------------------------------

# 最初のデータブロックを取得（対象エリアによって異なる場合あり）
area_data = data[0]

# 発表日時
publish_time = area_data["reportDatetime"]
print("■ 発表日時:", publish_time)

# 地域ごとの天気データ
for area in area_data["timeSeries"]:
    if area["area"]["name"] == "東京地方":
        # 時系列データから天気概要を取得
        weather_codes = area["areas"]["weatherCodes"]
        weathers = area["areas"]["weathers"]
        times = area_data["timeSeries"][0]["timeDefines"]

        print("\n■ 東京地方の天気予報")
        for i in range(len(weathers)):
            print(f"{times[i]} → {weathers[i]}")
        break

# ------------------------------------------------------------
# 参考：他のエリアコード
# - 大阪府：270000
# - 北海道（札幌）：016000
# - 福岡県：400000
# - 名古屋：230000
# - 広島：340000
# ------------------------------------------------------------
